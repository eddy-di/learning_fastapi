# Домашнее задание 2
---
Этот git-репозиторий создан исключительно для выполнения требований для прохождения стажировки в компании Y-Lab. Более подробная информация предназначена для модераторов, которые собираются ее протестировать. 

# Установка и настройка проекта в docker
## 1. Клонировать репозиторий git 

1. Откройте терминал. 
2. Измените текущую папку либо путь на тот, где вы хотите клонировать проект с ДЗ. 
3. Скопируйте эту строку кода. 

```
git clone https://github.com/eddy-di/learning_fastapi.git
```

4. Вставьте приведенную выше команду в терминал и нажмите Enter.

## 2. Запуск web сервера в docker (1, 2, 4 пункты домашнего задания 2)

1. Я предполагаю что у вас уже установлен Docker.
2. Введите в командную строку находясь в корневой директории проекта.

```
docker compose -f docker-compose.yaml up -d --build
```

3. Это позволит в виртуальной среде установить все пакеты и запустить проект в docker'e.
4. Проект доступен через браузер по адресу:

```
http://localhost:8000/docs
```

Вы должны будете увидеть такую старницу с реализованными эндпоинтами: ![image](./readme_images/schemas_menu.png "Пример эндпоинтов")

5. Для правильной реализации проверки тестов через постман убедитесь что порт `localhost` переменной в postman environment равна 8000. Если там стоит другое значение то надо будет изменить порт на 8000.
6. Для того чтобы потушить поднятый сервер в docker'e находясь в корневой директории проекта введите: 

```
docker compose -f docker-compose.yaml down -v
```

## 3. Запуск pytest тестов в docker (1, 2, 4 пункты домашнего задания 2)

1. Введите в терминале находясь в корневой директории проекта данную команду:

```
docker-compose -f docker-compose-tests.yaml up -d && docker logs --follow test_web && docker compose -f docker-compose-tests.yaml down -v
```

2. Это позволит вам увидеть в терминале результат успешно выполненных 32 тестов.
3. По пункту 4 (Реализовать тестовый сценарий «Проверка кол-ва блюд и подменю в меню» из Postman с помощью pytest) тесты этого сценария находятся в файле `test_case4_counters.py`. Доступны по [этой ссылке](https://github.com/eddy-di/learning_fastapi/blob/main/tests/test_case4_counters.py).
4. Юнит тесты проверяющие CRUD эндпоинтов доступны по [этой ссылке](https://github.com/eddy-di/learning_fastapi/blob/main/tests/test_crud.py).


## 4. Путь к сложному ORM запросу (3 пункт домашнего задания 2)

1. Можете увидеть выполнение SQLAlchemy ORM запроса по [этой ссылке](https://github.com/eddy-di/learning_fastapi/blob/main/app/main.py#L23) в функции `read_menus`.
2. В переменной `menus` хранится ORM запрос к базе данных. Начало 24 линия, конец 31.
---

